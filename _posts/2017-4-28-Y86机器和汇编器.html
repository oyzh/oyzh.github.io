---
layout: post
title: JavaScript实现Y86指令集机器和对应的汇编器
excerpt: CSAPP中用Y86描述了一个处理器的实现，这里我采用JavaScript实现了这个机器，同时为它实现了一个汇编器
---

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 简介</h2>
<div class="outline-text-2" id="text-1">
<p>
Y86指令集是一个非常小但是很完整的一个指令集，它包括数据转移指令、数值操作指令、条件跳转与转移指令和函数调用相关的指令等。采用一个顺序读取指令和执行指令的方式构建这样的机器比较容易（未考虑流水线实现）。虽然用JavaScript实现时不像硬件实现需要考虑硬件复用，例如对每一条指令分别进行判断并执行相关操作可以比较简单地实现这样的机器（类似动态语言的实现），但是我还是按照书上内容，将每条指令都按照（取指、译码&#x2026;）顺序执行，这样便于理解真实的机器是如何运作的。
</p>

<p>
为了能更方便的编写基于这台机器程序，实现一个汇编器还是很有必要，这个汇编器至少能支持书上写的程序，比如有符号定义和引用，还支持一些宏操作(.pos,.align等)用JavaScript进行字符串处理还是比较方便，因此汇编器也比较容易实现。
</p>

<p>
经过测试，书上数组求和程序可以成功运行，采用一个简单的网页来显示机器，它可以单步执行，并展示机器内部状态(寄存器，PC等)。
</p>

<p>
未来还可以做的还包括：
</p>
<ul class="org-ul">
<li>实现一个网页版的IDE，包括代码输入，调试等
</li>
<li>实现一个高级语言的编译器
</li>
<li>当前编译生成的是没有更多格式的二进制文件，未来可以设计以下可执行文件的格式，用专门的加载器加载，而不是像现在直接将所有代码直接复制到内存0地址处
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Y86机器的实现</h2>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 汇编器的实现</h2>

</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> 代码地址</h2>
<a href="https://www.github.com/oyzh/CSAPP-Y86">点击这里</a>
</div>
